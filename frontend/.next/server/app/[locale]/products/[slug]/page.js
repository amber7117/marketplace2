(()=>{var e={};e.id=309,e.ids=[309],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},9914:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>g,tree:()=>c});var a=r(7096),s=r(6132),i=r(7284),n=r.n(i),l=r(2564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let c=["",{children:["[locale]",{children:["products",{children:["[slug]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6153)),"/home/runner/work/marketplace2/marketplace2/frontend/app/[locale]/products/[slug]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2501)),"/home/runner/work/marketplace2/marketplace2/frontend/app/[locale]/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,5345)),"/home/runner/work/marketplace2/marketplace2/frontend/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,8196)),"/home/runner/work/marketplace2/marketplace2/frontend/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,4293)),"/home/runner/work/marketplace2/marketplace2/frontend/app/not-found.tsx"]}],d=["/home/runner/work/marketplace2/marketplace2/frontend/app/[locale]/products/[slug]/page.tsx"],u="/[locale]/products/[slug]/page",m={require:r,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/[locale]/products/[slug]/page",pathname:"/[locale]/products/[slug]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7685:(e,t,r)=>{Promise.resolve().then(r.bind(r,9563))},9563:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ProductDetailClient});var a=r(784),s=r(9885),i=r(4412),n=r(1440),l=r.n(n);let o={MYR:1,USD:.21,SGD:.29};let RatesProvider=class RatesProvider{constructor(){this.rates=o,this.lastUpdated=Date.now(),this.cacheDuration=36e5}static getInstance(){return RatesProvider.instance||(RatesProvider.instance=new RatesProvider),RatesProvider.instance}async getRates(){return Date.now()-this.lastUpdated>this.cacheDuration&&await this.refreshRates(),this.rates}async convertAmount(e,t,r){let a=await this.getRates();if(t===r)return e;let s=e/a[t],i=s*a[r];return Math.round(100*i)/100}async formatAmount(e,t){await this.getRates();let r=await this.convertAmount(e,"MYR",t);return new Intl.NumberFormat(this.getLocaleForCurrency(t),{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(r)}getLocaleForCurrency(e){return({MYR:"ms-MY",USD:"en-US",SGD:"en-SG"})[e]}async refreshRates(){this.lastUpdated=Date.now(),await new Promise(e=>setTimeout(e,100))}setRates(e){this.rates={...e},this.lastUpdated=Date.now()}getSupportedCurrencies(){return Object.keys(this.rates)}};let c=RatesProvider.getInstance();let PricingService=class PricingService{static async getProductPriceRange(e,t){let r=await Promise.all(e.offers.map(e=>this.convertOfferPrice(e,t)));return{min:Math.min(...r),max:Math.max(...r)}}static async convertOfferPrice(e,t){return c.convertAmount(e.price,"MYR",t)}static async formatPrice(e,t){return c.formatAmount(e,t)}static async calculateCartTotals(e,t,r=.06){let a=0;for(let r of e){let e=await this.convertOfferPrice(r.offer,t);a+=e*r.quantity}let s=a*r,i=a+s;return{subtotal:Math.round(100*a)/100,tax:Math.round(100*s)/100,total:Math.round(100*i)/100}}static async getLowestPrice(e,t){let r=await Promise.all(e.offers.map(e=>this.convertOfferPrice(e,t)));return Math.min(...r)}static async getHighestPrice(e,t){let r=await Promise.all(e.offers.map(e=>this.convertOfferPrice(e,t)));return Math.max(...r)}static calculateDiscount(e,t){return e<=t?0:Math.round((e-t)/e*100)}static async formatPriceRange(e,t){let r=await this.getProductPriceRange(e,t);if(r.min===r.max)return await this.formatPrice(r.min,t);let a=await this.formatPrice(r.min,t),s=await this.formatPrice(r.max,t);return`${a} - ${s}`}static async getDisplayPrice(e,t){let r=await this.getLowestPrice(e,t),a=e.offers.reduce((e,t)=>t.price<e.price?t:e),s={price:await this.formatPrice(r,t)};if(a.originalPrice&&a.originalPrice>a.price){let e=await this.convertOfferPrice({...a,price:a.originalPrice},t);s.originalPrice=await this.formatPrice(e,t),s.discount=this.calculateDiscount(a.originalPrice,a.price)}return s}};function useCurrency(){let[e,t]=(0,s.useState)("MYR");return(0,s.useEffect)(()=>{let e=document.cookie.split("; ").find(e=>e.startsWith("currency="))?.split("=")[1];e&&t(e)},[]),{currency:e,setCurrency:e=>{t(e),document.cookie=`currency=${e}; path=/; max-age=31536000`}}}function useCart(){let[e,t]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=localStorage.getItem("cart");if(e)try{t(JSON.parse(e))}catch(e){console.error("Failed to parse cart:",e)}},[]),(0,s.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(e))},[e]);let removeFromCart=r=>{t(e.filter(e=>e.lineId!==r))};return{items:e,addToCart:({product:r,offer:a,quantity:s})=>{let i=`${r.slug}-${a.id}`,n=e.find(e=>e.lineId===i);if(n)t(e.map(e=>e.lineId===i?{...e,quantity:e.quantity+s}:e));else{let{offers:n,...l}=r,o={lineId:i,slug:r.slug,offerId:a.id,quantity:s,product:l,offer:a};t([...e,o])}},removeFromCart,updateQuantity:(r,a)=>{if(a<=0){removeFromCart(r);return}t(e.map(e=>e.lineId===r?{...e,quantity:a}:e))},clearCart:()=>{t([])},getTotalItems:()=>e.reduce((e,t)=>e+t.quantity,0)}}var d=r(7114);function Price_Price({amount:e,currency:t,className:r="",showCurrency:i=!0}){let[n,l]=(0,s.useState)(""),[o,c]=(0,s.useState)(t||"MYR");return((0,s.useEffect)(()=>{let getCurrency=()=>{if(t)return t;let e=document.cookie.split("; ").find(e=>e.startsWith("currency="))?.split("=")[1]||"MYR";return e},formatPrice=async()=>{let t=getCurrency();c(t);let r=await PricingService.formatPrice(e,t);l(r)};formatPrice()},[e,t]),n)?a.jsx("span",{className:r,children:i?n:n.replace(/[A-Z$€£¥]+\s?/g,"")}):a.jsx("span",{className:r,children:"..."})}var u=r(5188),m=r.n(u);function ProductDetailClient({product:e,locale:t}){let r=(0,i.useTranslations)("Product"),{currency:n}=useCurrency(),{addToCart:o}=useCart(),c=(0,d.useRouter)(),[u,g]=(0,s.useState)(e.offers[0]),[p,x]=(0,s.useState)(1),[h,f]=(0,s.useState)("description"),[b,y]=(0,s.useState)(0),[j,P]=(0,s.useState)(!1),[v,w]=(0,s.useState)(0),[N,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{let calculatePrices=async()=>{let e=await PricingService.convertOfferPrice(u,n);if(w(e),u.originalPrice){let e=await PricingService.convertOfferPrice({...u,price:u.originalPrice},n);k(e)}else k(null)};calculatePrices()},[u,n]);let C=v*p,S=m()(e.description,{allowedTags:m().defaults.allowedTags.concat(["h2","h3"]),allowedAttributes:{...m().defaults.allowedAttributes,"*":["class"]}}),M=e.usageGuide?m()(e.usageGuide,{allowedTags:m().defaults.allowedTags.concat(["h2","h3"]),allowedAttributes:{...m().defaults.allowedAttributes,"*":["class"]}}):"";return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"mb-6 text-sm text-gray-600",children:[a.jsx(l(),{href:`/${t}`,className:"hover:text-blue-600",children:"Home"})," / ",a.jsx(l(),{href:`/${t}/products`,className:"hover:text-blue-600",children:"Products"})," / ",a.jsx("span",{className:"text-gray-900",children:e.name})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"bg-white rounded-lg overflow-hidden mb-4 cursor-pointer",onClick:()=>P(!0),children:a.jsx("div",{className:"aspect-w-16 aspect-h-9 relative h-96",children:a.jsx("img",{src:e.images[b],alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23ddd" width="400" height="300"/%3E%3Ctext fill="%23999" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3EProduct Image%3C/text%3E%3C/svg%3E'}})})}),e.images.length>1&&a.jsx("div",{className:"flex gap-2 overflow-x-auto",children:e.images.map((t,r)=>a.jsx("button",{onClick:()=>y(r),className:`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 ${b===r?"border-blue-600":"border-gray-200"}`,children:a.jsx("img",{src:t,alt:`${e.name} ${r+1}`,className:"w-full h-full object-cover"})},r))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[e.featured&&a.jsx("span",{className:"inline-block bg-yellow-100 text-yellow-800 text-xs px-3 py-1 rounded-full mb-2",children:r("featured")}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e.name}),a.jsx("p",{className:"text-gray-600 mb-4",children:e.shortDescription}),(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"flex text-yellow-400 text-lg",children:Array.from({length:5}).map((t,r)=>a.jsx("span",{children:r<Math.floor(e.rating)?"★":"☆"},r))}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 ml-2",children:[e.rating," (",e.reviewCount," ",r("reviews"),")"]})]}),(0,a.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[r("brand"),": "]}),a.jsx("span",{className:"text-sm font-medium",children:e.brand})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[r("region"),": "]}),e.regions.map(e=>a.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full ml-1",children:e},e))]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:r("selectDenomination")}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:e.offers.map(e=>a.jsx("button",{onClick:()=>g(e),className:`p-3 border-2 rounded-lg transition-all ${u.id===e.id?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,disabled:0===e.stock,children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-bold",children:e.denomination}),a.jsx("div",{className:"text-xs text-gray-500",children:e.stock>0?(0,a.jsxs)("span",{className:"text-green-600",children:[e.stock," ",r("stockLeft")]}):a.jsx("span",{className:"text-red-600",children:r("outOfStock")})})]})},e.id))})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsx(Price_Price,{amount:v,currency:n,className:"text-3xl font-bold text-gray-900"}),N&&a.jsx(Price_Price,{amount:N,currency:n,className:"text-lg text-gray-500 line-through"}),u.discount&&(0,a.jsxs)("span",{className:"text-lg text-green-600 font-semibold",children:["-",u.discount,"%"]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[r("denomination"),": ",u.denomination," ",u.currency]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("quantity")}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>x(Math.max(1,p-1)),className:"w-10 h-10 flex items-center justify-center border border-gray-300 rounded-lg hover:bg-gray-50",children:"-"}),a.jsx("input",{type:"number",value:p,onChange:e=>x(Math.max(1,parseInt(e.target.value)||1)),className:"w-20 h-10 text-center border border-gray-300 rounded-lg",min:"1",max:u.stock}),a.jsx("button",{onClick:()=>x(Math.min(u.stock,p+1)),className:"w-10 h-10 flex items-center justify-center border border-gray-300 rounded-lg hover:bg-gray-50",disabled:p>=u.stock,children:"+"})]})]}),a.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-lg font-medium text-gray-700",children:[r("total"),":"]}),a.jsx(Price_Price,{amount:C,currency:n,className:"text-2xl font-bold text-blue-600"})]})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{o({product:e,offer:u,quantity:p}),alert(r("addedToCart"))},disabled:0===u.stock,className:"flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed",children:r("addToCart")}),a.jsx("button",{onClick:()=>{o({product:e,offer:u,quantity:p}),c.push(`/${t}/checkout`)},disabled:0===u.stock,className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed",children:r("buyNow")})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6",children:[a.jsx("div",{className:"border-b border-gray-200 mb-6",children:(0,a.jsxs)("div",{className:"flex gap-6",children:[a.jsx("button",{onClick:()=>f("description"),className:`pb-3 px-1 border-b-2 transition-colors ${"description"===h?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:r("description")}),e.usageGuide&&a.jsx("button",{onClick:()=>f("guide"),className:`pb-3 px-1 border-b-2 transition-colors ${"guide"===h?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:r("howToUse")}),a.jsx("button",{onClick:()=>f("specs"),className:`pb-3 px-1 border-b-2 transition-colors ${"specs"===h?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:r("specifications")})]})}),(0,a.jsxs)("div",{className:"prose max-w-none",children:["description"===h&&a.jsx("div",{dangerouslySetInnerHTML:{__html:S}}),"guide"===h&&e.usageGuide&&a.jsx("div",{dangerouslySetInnerHTML:{__html:M}}),"specs"===h&&a.jsx("div",{children:a.jsx("table",{className:"w-full",children:(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("td",{className:"py-3 font-medium text-gray-700",children:r("brand")}),a.jsx("td",{className:"py-3 text-gray-900",children:e.brand})]}),(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("td",{className:"py-3 font-medium text-gray-700",children:r("region")}),a.jsx("td",{className:"py-3 text-gray-900",children:e.regions.join(", ")})]}),(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Category"}),a.jsx("td",{className:"py-3 text-gray-900 capitalize",children:e.category})]}),e.supportedGames&&e.supportedGames.length>0&&(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("td",{className:"py-3 font-medium text-gray-700",children:r("supportedGames")}),a.jsx("td",{className:"py-3 text-gray-900",children:a.jsx("ul",{className:"list-disc list-inside",children:e.supportedGames.map((e,t)=>a.jsx("li",{children:e},t))})})]}),(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Available Denominations"}),(0,a.jsxs)("td",{className:"py-3 text-gray-900",children:[e.offers.map(e=>e.denomination).join(", ")," ",e.offers[0].currency]})]})]})})})]})]})]}),j&&(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:()=>P(!1),children:[a.jsx("button",{onClick:()=>P(!1),className:"absolute top-4 right-4 text-white text-4xl hover:text-gray-300",children:"\xd7"}),a.jsx("img",{src:e.images[b],alt:e.name,className:"max-w-full max-h-full object-contain"}),e.images.length>1&&a.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2",children:e.images.map((e,t)=>a.jsx("button",{onClick:e=>{e.stopPropagation(),y(t)},className:`w-3 h-3 rounded-full ${b===t?"bg-white":"bg-gray-500"}`},t))})]})]})}},6153:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ProductDetailPage,generateMetadata:()=>generateMetadata});var a=r(4656),s=r(1412),i=r(5153);let n=(0,i.createProxy)(String.raw`/home/runner/work/marketplace2/marketplace2/frontend/app/[locale]/products/[slug]/ProductDetailClient.tsx`),{__esModule:l,$$typeof:o}=n,c=n.default,d=[{id:"1",slug:"playstation-network-card",name:"PlayStation Network Card",description:`<h2>About PlayStation Network Card</h2>
      <p>Top up your PlayStation Network wallet instantly with digital codes. Perfect for purchasing games, DLC, and subscriptions on the PlayStation Store.</p>
      <h3>Features:</h3>
      <ul>
        <li>Instant delivery</li>
        <li>No expiration date</li>
        <li>Compatible with PS4 and PS5</li>
        <li>Works with all PSN accounts in Malaysia</li>
      </ul>`,shortDescription:"PSN credit for games and subscriptions",category:"gaming",brand:"Sony",images:["/products/playstation-network-card/cover.jpg","/products/playstation-network-card/detail1.jpg","/products/playstation-network-card/detail2.jpg"],offers:[{id:"offer-1",denomination:50,currency:"MYR",price:45,originalPrice:50,discount:10,stock:100,region:"Malaysia"},{id:"offer-2",denomination:100,currency:"MYR",price:90,originalPrice:100,discount:10,stock:50,region:"Malaysia"},{id:"offer-3",denomination:150,currency:"MYR",price:135,originalPrice:150,discount:10,stock:75,region:"Malaysia"}],regions:["Malaysia"],tags:["gaming","psn","sony","playstation"],rating:4.5,reviewCount:128,featured:!0,supportedGames:["All PlayStation games","PS Plus subscriptions","PlayStation Store content"],usageGuide:`<h3>How to Redeem:</h3>
      <ol>
        <li>Go to PlayStation Store on your console or web browser</li>
        <li>Select your account and click "Redeem Codes"</li>
        <li>Enter the 12-digit code you received</li>
        <li>Your wallet will be credited instantly</li>
      </ol>
      <p><strong>Important:</strong> Make sure your PSN account region matches the card region.</p>`}];async function getProduct(e){return d.find(t=>t.slug===e)}async function generateMetadata({params:e}){let t=await getProduct(e.slug);if(!t)return{title:"Product Not Found"};let r=Math.min(...t.offers.map(e=>e.price));return t.offers.map(e=>e.price),{title:`${t.name} - Buy Digital Gift Cards`,description:t.shortDescription||t.description.substring(0,160),keywords:t.tags.join(", "),openGraph:{title:t.name,description:t.shortDescription,images:t.images.map(e=>({url:e,alt:t.name})),type:"website"},alternates:{canonical:`https://marketplace.example.com/${e.locale}/products/${e.slug}`,languages:{en:`/en/products/${e.slug}`,zh:`/zh/products/${e.slug}`}},other:{"product:price:amount":r.toString(),"product:price:currency":"MYR"}}}function generateProductSchema(e,t){let r=Math.min(...e.offers.map(e=>e.price)),a=Math.max(...e.offers.map(e=>e.price));return{"@context":"https://schema.org","@type":"Product",name:e.name,description:e.shortDescription,image:e.images,brand:{"@type":"Brand",name:e.brand},offers:{"@type":"AggregateOffer",priceCurrency:"MYR",lowPrice:r,highPrice:a,offerCount:e.offers.length,availability:"https://schema.org/InStock"},aggregateRating:{"@type":"AggregateRating",ratingValue:e.rating,reviewCount:e.reviewCount}}}async function ProductDetailPage({params:e}){let t=await getProduct(e.slug);t||(0,s.notFound)();let r=generateProductSchema(t,e.locale);return(0,a.jsxs)(a.Fragment,{children:[a.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(r)}}),a.jsx(c,{product:t,locale:e.locale})]})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[6,492,504,534,761,502],()=>__webpack_exec__(9914));module.exports=r})();